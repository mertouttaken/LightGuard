settings:
  prefix: "&8[&bLightGuard&8] &7"

  kick-layout:
    - "&4&m-----------------------------------------"
    - "&c&lLIGHTGUARD SECURITY"
    - ""
    - "&fUser: &7%player%"
    - "&fDetection: &c%check% &7(&e%packet%&7)"
    - "&fPing: &e%ping%ms"
    - ""
    - "&4&l⛔ ACTION BLOCKED ⛔"
    - "&7You have violated server security."
    - "&4&m-----------------------------------------"

  sentinel:
    enabled: true
    silent-failures: false # Log on error instead of crashing the server
    geyser-support: true
    critical-checks:
      - "NBTExploit"      # Item NBT (Very critical, crashes server)
      - "ItemExploit"     # Item Attribute (Critical)
      - "Payload"         # Crash client channels
      - "Flood"           # Packet flooding

checks:
  anvil:
    enabled: true

  raw-packet:
    enabled: true
    # Maximum raw packet size (in Bytes).
    # 2MB (2097152) is the safe limit for vanilla.
    # Book Ban or Map exploits push this limit.
    max-raw-size: 2097152

  packet-size:
    enabled: true
    max-string-length: 10000
    max-buffer-size: 16384
    per-packet-limit: 32000
    excluded-packets:
      - "PacketPlayInCustomPayload"
      - "PacketPlayInBEdit"

  window:
    enabled: true
    strict-slots: true
    prevent-lectern-spam: true
    prevent-swap-in-gui: true

  sign:
    enabled: true
    max-line-length: 45 # Max characters per line
    block-json-syntax: true # Blocks JSON injection like {"text":"..."}

  game-state:
    enabled: true
    check-inventory-open: true

  vehicle:
    enabled: true
    check-steer: true
    prevent-invalid-move: true

  map-exploit:
      enabled: true
      max-pps: 5
      max-nbt-size: 8192

  chat-unicode:
    enabled: true
    block-zalgo: true

  bad-packets:
    enabled: true
    check-negative-values: true
    prevent-self-interact: true

  client-brand:
    enabled: true
    max-length: 20 # Shortened brand name (e.g., "Lunar-Client" fits but spam won't)
    block-invalid-chars: true

  resource-pack:
    enabled: true
    max-status-length: 100 # Status packet length
    block-invalid-status: true

  entity:
    enabled: true
    prevent-invalid-entity: true
    prevent-armorstand-spam: true

  flood:
    enabled: true
    # Maximum allowed data size per second (Bytes)
    max-bytes-per-sec: 40000

    # Instant packet burst limit
    burst-limit: 400

    # Global Packets Per Second Limit (PPS)
    max-global-pps: 600

    # System that relaxes or tightens limits based on server status
    adaptive:
      enabled: true
      low-tps-threshold: 18.0   # If TPS drops below 18
      low-tps-multiplier: 0.7   # Tighten limits by 30% (Stricter protection)
      high-tps-threshold: 19.8  # If TPS is above 19.8 (Server is healthy)
      high-tps-multiplier: 1.2  # Relax limits by 20% (Prevents False Positives)
      high-player-threshold: 50 # If over 50 players
      high-player-multiplier: 1.1 # Relax limits by 10%

    # Scoring system based on packet processing cost
    matrix:
      enabled: true
      max-weight-per-sec: 1200.0
      weights:
        PacketPlayInWindowClick: 50.0
        PacketPlayInSetCreativeSlot: 45.0
        PacketPlayInBlockDig: 35.0
        PacketPlayInUseItem: 25.0
        PacketPlayInBEdit: 40.0
        PacketPlayInUseEntity: 15.0
        PacketPlayInArmAnimation: 5.0
        PacketPlayInEntityAction: 8.0
        PacketPlayInFlying: 2.0
        PacketPlayInPosition: 2.0
        PacketPlayInLook: 1.5
        PacketPlayInPositionLook: 2.5
        PacketPlayInKeepAlive: 12.0
        PacketPlayInTransaction: 12.0
        default: 5.0

    limits:
      # Movement
      PacketPlayInFlying: "25/1000"
      PacketPlayInPosition: "25/1000"
      PacketPlayInLook: "30/1000"
      PacketPlayInPositionLook: "25/1000"

      # Actions
      PacketPlayInArmAnimation: "50/1000"
      PacketPlayInBlockDig: "70/1000"
      PacketPlayInUseItem: "35/1000"
      PacketPlayInUseEntity: "20/1000"
      PacketPlayInEntityAction: "25/1000"

      # Inventory (Dupe-sensitive)
      PacketPlayInWindowClick: "30/500"
      PacketPlayInSetCreativeSlot: "25/1000"
      PacketPlayInPickItem: "12/1000"
      PacketPlayInCloseWindow: "15/1000"

      # Anticheat bypass detection
      PacketPlayInKeepAlive: "12/1000"
      PacketPlayInTransaction: "18/1000"
      PacketPlayInTeleportAccept: "12/1000"

      # Recipe & Book
      PacketPlayInAutoRecipe: "8/1000"
      PacketPlayInRecipeDisplayed: "8/1000"
      PacketPlayInRecipeSettings: "12/1000"
      PacketPlayInBEdit: "5/2000"

      # Trading & Merchants
      PacketPlayInTrSel: "12/1000"

      # System commands
      PacketPlayInClientCommand: "8/1000"
      PacketPlayInSpectate: "8/1000"
      PacketPlayInAdvancements: "8/1000"
      PacketPlayInDifficultyLock: "5/2000"
      PacketPlayInDifficultyChange: "5/2000"

      # Communication
      PacketPlayInCustomPayload: "20/1000"
      PacketPlayInTabComplete: "15/1000"
      PacketPlayInChat: "12/2000"

      # Misc
      PacketPlayInVehicleMove: "25/1000"
      PacketPlayInSteerVehicle: "25/1000"
      PacketPlayInAbilities: "10/1000"
      PacketPlayInBeacon: "10/1000"
      PacketPlayInEnchantItem: "15/1000"
      PacketPlayInResourcePackStatus: "5/2000"
      PacketPlayInUpdateSign: "8/1000"
      PacketPlayInItemName: "10/1000"

  block-place:
    enabled: true
    kick-on-illegal-block: true # No forgiveness
    max-pps: 12 # More than 12 blocks per second (Printer/FastPlace) are blocked.
    check-coordinates: true

    # Printer Detection
    printer-check: true
    printer-threshold: 8 # Over 8 PPS is suspicious
    printer-leave-delay: 5000 # 5s wait penalty when disabling printer

    velocity:
      a: "80/500" # Velocity check tightened
      b: "50/1000"

    prevent-illegal-blocks: true
    illegal-blocks:
      - "COMMAND_BLOCK"
      - "REPEATING_COMMAND_BLOCK"
      - "CHAIN_COMMAND_BLOCK"
      - "STRUCTURE_VOID"
      - "STRUCTURE_BLOCK"
      - "JIGSAW"
      - "LIGHT"

  item:
    enabled: true
    max-item-depth: 3 # Nested NBT (Shulker inside Shulker) forbidden.
    max-nbt-size: 8000
    max-items-per-packet: 500 # Restricted bulk packet sending.
    max-string-len: 200 # Lore/Name length cannot exceed 200 characters.
    max-list-size: 15 # An item can have max 15 lines of lore.
    max-depth: 15
    max-attributes: 15
    max-attribute-value: 2048.0

    illegal-keys:
      - "run_command"
      - "clickEvent"
      - "hoverEvent"
      - "Score" # Scoreboard exploit
      - "Selector" # Selector exploit
      - "translation.test.invalid"

    nbt-occurrences:
      - "extra:15"      # Block JSON bombs
      - "{:50"          # Block nested NBT
      - "translate:5"   # Block translation key spam
      - "score:5"       # Block Scoreboard crash

  position:
    enabled: true
    max-offset: 20.0 # Stricter movement area
    elytra-speed-limit: 4.0
    out-of-world-limit: 30000000.0
    check-teleport-delay: true
    ignore-fly: true

  book:
    enabled: true
    max-pages: 5 # No one should write a novel, 5 pages is enough.
    max-bytes-per-page: 200
    strip-ascii: true

  payload:
    enabled: true
    max-size: 1500 # Large packets (except Maps etc.) are blocked.
    max-frequency: "5/1000" # Payload spam ended.
    blocked-channels:
      - "MC|BEdit"
      - "MC|BSign"
      - "MC|BOpen"
      - "PacketPlayInUpdateSign"
      - "WDL|INIT"
      - "PERMISSIONS_REPL"
      - "MC|TrList"
      - "minecraft:bedit"
      - "minecraft:bsign"
      - "minecraft:bopen"
  command:
    enabled: true
    block-syntax: true
    blacklist:
      - "/calc"
      - "//calc"
      - "/eval"
      - "/solve"
      - "/hd readtext"
      - "/pex"
      - "/op"
      - "/deop"
      - "/stop"
      - "/minecraft:me"
      - "/bukkit:me"
      - "/me"
      - "/execute"
      - "/function"

  tab:
    enabled: true
    max-length: 48 # Long command completions blocked.
    block-chars: ["[", "]", "{", "}", "\\", ":", ";"]
    block-contains:
      - "targetoffset"
      - "for("
      - "selector"
      - "run_command"
      - "^(."
      - "*."
      - "execute"
      - "summon"
    blacklisted-commands:
      - "/ver"
      - "/version"
      - "/about"
      - "/?"
      - "/help"
      - "/pl"
      - "/plugins"
      - "/bukkit:ver"
      - "/bukkit:pl"
      - "/minecraft:me"

packet-logger:
  enabled: false
  heavy-packet-threshold: 1000000 # 1ms (nanoseconds)
  output: FILE
  players: []
  packet-mode: BLACKLIST # WHITELIST or BLACKLIST
  packets:
    - "PacketPlayInKeepAlive"
    - "PacketPlayInFlying"

mechanics:
  nether-portal-delay: true
  nether-portal-cooldown-ms: 3000 # 3s cooldown after passing through portal
  max-arrow-velocity: 15.0 # Bow speed significantly reduced
  shears-cooldown: true
  break-close-inventory: true
  trapdoor-rail-redstone: true
  interact-container-delay: 200 # Chest opening interval 200ms (No spam)
  prevent-portal-break: true
  prevent-mule-dupe: true
  block-dead-packets: true
  null_chunk: true
  self_damage: true
  bed_duplication: true
  disable-piglin-trading: false
  close-inventory-on-teleport: true
  limit-falling-blocks: true
  max-falling-blocks-per-chunk: 15
  prevent-nether-roof: true
  limit-map-creation: true
  prevent-invalid-trade: true
  prevent-piston-crash: true