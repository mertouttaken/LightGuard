settings:
  prefix: "&8[&bLightGuard&8] &7"

  kick-layout:
    - "&4&m-----------------------------------------"
    - "&c&lLIGHTGUARD SECURITY"
    - ""
    - "&fUser: &7%player%"
    - "&fDetection: &c%check% &7(&e%packet%&7)"
    - "&fPing: &e%ping%ms"
    - ""
    - "&4&l⛔ ACTION BLOCKED ⛔"
    - "&7You have violated server security."
    - "&4&m-----------------------------------------"

  sentinel:
    enabled: true
    silent-failures: false # Log on error instead of crashing the server
    geyser-support: true
    critical-checks:
      - "NBTExploit"      # Item NBT (Very critical, crashes server)
      - "ItemExploit"     # Item Attribute (Critical)
      - "Payload"         # Crash client channels
      - "Flood"           # Packet flooding

checks:
  raw-packet:
    enabled: true
    # Maximum raw packet size (in Bytes).
    # 2MB (2097152) is the safe limit for vanilla.
    # Book Ban or Map exploits push this limit.
    max-raw-size: 2097152

  packet-size:
    enabled: true
    max-string-length: 10000
    max-buffer-size: 16384
    per-packet-limit: 32000
    excluded-packets:
      - "PacketPlayInCustomPayload"

  window:
    enabled: true
    strict-slots: true
    prevent-lectern-spam: true
    prevent-swap-in-gui: true

  sign:
    enabled: true
    max-line-length: 45 # Max characters per line
    block-json-syntax: true # Blocks JSON injection like {"text":"..."}

  game-state:
    enabled: true
    check-inventory-open: true

  vehicle:
    enabled: true
    check-steer: true
    prevent-invalid-move: true

  map-exploit:
      enabled: true
      max-pps: 5
      max-nbt-size: 8192

  chat-unicode:
    enabled: true
    block-zalgo: true

  bad-packets:
    enabled: true
    check-negative-values: true
    prevent-self-interact: true

  client-brand:
    enabled: true
    max-length: 20 # Shortened brand name (e.g., "Lunar-Client" fits but spam won't)
    block-invalid-chars: true

  resource-pack:
    enabled: true
    max-status-length: 100 # Status packet length
    block-invalid-status: true

  entity:
    enabled: true
    prevent-invalid-entity: true
    prevent-armorstand-spam: true

  flood:
    enabled: true
    # Maximum allowed data size per second (Bytes)
    max-bytes-per-sec: 40000

    # Instant packet burst limit
    burst-limit: 400

    # Global Packets Per Second Limit (PPS)
    max-global-pps: 600

    # System that relaxes or tightens limits based on server status
    adaptive:
      enabled: true
      low-tps-threshold: 18.0   # If TPS drops below 18
      low-tps-multiplier: 0.7   # Tighten limits by 30% (Stricter protection)
      high-tps-threshold: 19.8  # If TPS is above 19.8 (Server is healthy)
      high-tps-multiplier: 1.2  # Relax limits by 20% (Prevents False Positives)
      high-player-threshold: 50 # If over 50 players
      high-player-multiplier: 1.1 # Relax limits by 10%

    # Scoring system based on packet processing cost
    matrix:
      enabled: true
      max-weight-per-sec: 1000.0
      weights:
        PacketPlayInWindowClick: 50.0   # Heaviest operation (Inventory)
        PacketPlayInBlockDig: 30.0      # Block breaking
        PacketPlayInUseItem: 20.0       # Item usage
        PacketPlayInArmAnimation: 5.0   # Hand swinging
        PacketPlayInFlying: 2.0         # Movement (Position/Look)
        PacketPlayInKeepAlive: 10.0     # Disabler potential
        PacketPlayInTransaction: 10.0   # Disabler potential
        default: 5.0                    # Undefined packets

    limits:
      PacketPlayInFlying: "22/1000"
      PacketPlayInPosition: "22/1000"
      PacketPlayInLook: "22/1000"
      PacketPlayInPositionLook: "22/1000"
      PacketPlayInArmAnimation: "40/1000"
      PacketPlayInBlockDig: "60/1000"
      PacketPlayInUseItem: "30/1000"
      PacketPlayInWindowClick: "25/500"
      PacketPlayInUseEntity: "15/1000"

      # --- ANTI-CHEAT & DISABLER (Test 12, 15) ---
      PacketPlayInKeepAlive: "10/1000"
      PacketPlayInTransaction: "15/1000"
      PacketPlayInTeleportAccept: "10/1000" # (Teleport Confirm)

      # --- CREATIVE & INVENTORY (Test 27, 35) ---
      PacketPlayInSetCreativeSlot: "20/1000" # (Slot Hash)
      PacketPlayInPickItem: "10/1000"        # (Pick Item)

      # --- RECIPE & BOOK (Test 14, 24, 33) ---
      PacketPlayInAutoRecipe: "5/1000"       # (Recipe Crash)
      PacketPlayInRecipeSettings: "10/1000"  # Recipe Book spam
      PacketPlayInTrSel: "10/1000"           # Merchant Trade spam

      # --- SYSTEM & STATE (Test 22, 29, 30, 32) ---
      PacketPlayInClientCommand: "5/1000"    # (Respawn/Stats spam)
      PacketPlayInSpectate: "5/1000"         # (Spectate spam)
      PacketPlayInAdvancements: "5/1000"     # (Advancement spam)
      PacketPlayInDifficultyLock: "5/1000"   # (Difficulty spam)
      PacketPlayInDifficultyChange: "5/1000" # (Alternative name)

      # --- PAYLOAD & TAB (Test 3) ---
      PacketPlayInCustomPayload: "15/1000"   # (Payload spam)
      PacketPlayInTabComplete: "10/1000"     # Tab spam

      PacketPlayInMap: "10/1000"           # Map Spam
      PacketPlayInChat: "10/2000"          # Chat Spam (10 messages in 2 seconds)

      PacketPlayInEntityAction: "20/1000"
      PacketPlayInVehicleMove: "22/1000"
      PacketPlayInAbilities: "10/1000"
      PacketPlayInBEdit: "5/2000"
      PacketPlayInBeacon: "10/1000"
      PacketPlayInEnchantItem: "10/1000"
      PacketPlayInResourcePackStatus: "5/1000"

  block-place:
    enabled: true
    kick-on-illegal-block: true # No forgiveness
    max-pps: 12 # More than 12 blocks per second (Printer/FastPlace) are blocked.
    check-coordinates: true

    # Printer Detection
    printer-check: true
    printer-threshold: 8 # Over 8 PPS is suspicious
    printer-leave-delay: 5000 # 5s wait penalty when disabling printer

    velocity:
      a: "80/500" # Velocity check tightened
      b: "50/1000"

    prevent-illegal-blocks: true
    illegal-blocks:
      - "COMMAND_BLOCK"
      - "REPEATING_COMMAND_BLOCK"
      - "CHAIN_COMMAND_BLOCK"
      - "STRUCTURE_VOID"
      - "STRUCTURE_BLOCK"
      - "JIGSAW"
      - "LIGHT"

  item:
    enabled: true
    max-item-depth: 3 # Nested NBT (Shulker inside Shulker) forbidden.
    max-nbt-size: 8000
    max-items-per-packet: 500 # Restricted bulk packet sending.
    max-string-len: 200 # Lore/Name length cannot exceed 200 characters.
    max-list-size: 15 # An item can have max 15 lines of lore.
    max-depth: 15
    max-attributes: 15
    max-attribute-value: 2048.0

    illegal-keys:
      - "run_command"
      - "clickEvent"
      - "hoverEvent"
      - "Score" # Scoreboard exploit
      - "Selector" # Selector exploit
      - "translation.test.invalid"

    nbt-occurrences:
      - "extra:15"      # Block JSON bombs
      - "{:50"          # Block nested NBT
      - "translate:5"   # Block translation key spam
      - "score:5"       # Block Scoreboard crash

  position:
    enabled: true
    max-offset: 20.0 # Stricter movement area
    elytra-speed-limit: 4.0
    out-of-world-limit: 30000000.0
    check-teleport-delay: true
    ignore-fly: true

  book:
    enabled: true
    max-pages: 5 # No one should write a novel, 5 pages is enough.
    max-bytes-per-page: 200
    strip-ascii: true

  payload:
    enabled: true
    max-size: 1500 # Large packets (except Maps etc.) are blocked.
    max-frequency: "5/1000" # Payload spam ended.
    blocked-channels:
      - "MC|BEdit"
      - "MC|BSign"
      - "MC|BOpen"
      - "PacketPlayInUpdateSign"
      - "WDL|INIT"
      - "PERMISSIONS_REPL"
      - "MC|TrList"
      - "minecraft:bedit"
      - "minecraft:bsign"
      - "minecraft:bopen"
  command:
    enabled: true
    block-syntax: true
    blacklist:
      - "/calc"
      - "//calc"
      - "/eval"
      - "/solve"
      - "/hd readtext"
      - "/pex"
      - "/op"
      - "/deop"
      - "/stop"
      - "/minecraft:me"
      - "/bukkit:me"
      - "/me"

  tab:
    enabled: true
    max-length: 48 # Long command completions blocked.
    block-chars: ["[", "]", "{", "}", "\\", ":", ";"]
    block-contains:
      - "targetoffset"
      - "for("
      - "selector"
      - "run_command"
      - "^(."
      - "*."

packet-logger:
  enabled: false
  heavy-packet-threshold: -1
  output: FILE
  players: []
  packets: ["KEEP_ALIVE"]
  packet-mode: BLACKLIST

mechanics:
  nether-portal-delay: true
  nether-portal-cooldown-ms: 3000 # 3s cooldown after passing through portal
  max-arrow-velocity: 10.0 # Bow speed significantly reduced
  shears-cooldown: true
  break-close-inventory: true
  trapdoor-rail-redstone: true
  interact-container-delay: 200 # Chest opening interval 200ms (No spam)
  prevent-portal-break: true
  prevent-mule-dupe: true
  block-dead-packets: true
  null_chunk: true
  self_damage: true
  bed_duplication: true
  disable-piglin-trading: true
  close-inventory-on-teleport: true
  limit-falling-blocks: true
  max-falling-blocks-per-chunk: 10
  prevent-nether-roof: true
  limit-map-creation: true
  prevent-invalid-trade: true
  prevent-piston-crash: true