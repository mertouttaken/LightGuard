settings:
  prefix: "&8[&bLightGuard&8] &7"

  kick-layout:
    - "&4&m-----------------------------------------"
    - "&c&lLIGHTGUARD SECURITY"
    - ""
    - "&fUser: &7%player%"
    - "&fDetection: &c%check% &7(&e%packet%&7)"
    - "&fPing: &e%ping%ms"
    - ""
    - "&4&l⛔ ACTION BLOCKED ⛔"
    - "&7You have violated server security."
    - "&4&m-----------------------------------------"

  sentinel:
    enabled: true
    silent-failures: false # Log on error instead of crashing the server
    geyser-support: true
    critical-checks:
      - "NBTExploit"      # Item NBT (Very critical, crashes server)
      - "ItemExploit"     # Item Attribute (Critical)
      - "Payload"         # Crash client channels
      - "Flood"           # Packet flooding
      - "PacketSize"

checks:
  anvil:
    enabled: true

  recipe:
    enabled: true

  keep-alive:
    enabled: true

  raw-packet:
    enabled: true
    # Maximum raw packet size (in Bytes).
    # Book Ban or Map exploits push this limit.
    max-raw-size: 40960

  packet-size:
    enabled: true
    max-string-length: 8192
    max-buffer-size: 16384
    per-packet-limit: 32000
    excluded-packets:
      - "PacketPlayInCustomPayload"
      - "PacketPlayInBEdit"

  window:
    enabled: true
    strict-slots: true
    prevent-lectern-spam: true
    prevent-swap-in-gui: true

  sign:
    enabled: true
    max-line-length: 45 # Max characters per line
    block-json-syntax: true # Blocks JSON injection like {"text":"..."}

  game-state:
    enabled: true
    check-inventory-open: true

  eof-exploit:
    enabled: true

  vehicle:
    enabled: true
    check-steer: true
    prevent-invalid-move: true

  map-exploit:
      enabled: true
      max-pps: 3
      max-nbt-size: 4096

  chat-unicode:
    enabled: true
    block-zalgo: true

  bad-packets:
    enabled: true
    check-negative-values: true
    prevent-self-interact: true

  client-brand:
    enabled: true
    max-length: 30 # Shortened brand name (e.g., "Lunar-Client" fits but spam won't)
    block-invalid-chars: true

  resource-pack:
    enabled: true
    max-status-length: 50 # Status packet length
    block-invalid-status: true

  entity:
    enabled: true
    prevent-invalid-entity: true
    prevent-armorstand-spam: true

  flood:
    enabled: true
    # Maximum allowed data size per second (Bytes)
    max-bytes-per-sec: 40000

    # Instant packet burst limit
    burst-limit: 300

    # Global Packets Per Second Limit (PPS)
    max-global-pps: 500

    # System that relaxes or tightens limits based on server status
    adaptive:
      enabled: true
      low-tps-threshold: 19.0   # If TPS drops below 19
      low-tps-multiplier: 0.5   # Tighten limits (Stricter protection)
      high-tps-threshold: 19.9  # If TPS is above 19.9 (Server is healthy)
      high-tps-multiplier: 1.0  # Relax limits(Prevents False Positives)
      high-player-threshold: 100 # If over 100 players
      high-player-multiplier: 1.1 # Relax limits by 10%

    # Scoring system based on packet processing cost
    matrix:
      enabled: true
      max-weight-per-sec: 1000.0
      weights:
        PacketPlayInWindowClick: 80.0
        PacketPlayInSetCreativeSlot: 100.0 
        PacketPlayInBlockDig: 35.0
        PacketPlayInUseItem: 30.0
        PacketPlayInBEdit: 100.0
        PacketPlayInUseEntity: 20.0
        PacketPlayInArmAnimation: 5.0
        PacketPlayInEntityAction: 10.0
        PacketPlayInFlying: 1.0
        PacketPlayInPosition: 1.0
        PacketPlayInLook: 1.0
        PacketPlayInKeepAlive: 15.0
        PacketPlayInTransaction: 15.0
        default: 10.0

    limits:
      # Movement
      PacketPlayInFlying: "25/1000"
      PacketPlayInPosition: "25/1000"
      PacketPlayInLook: "40/1000"
      PacketPlayInPositionLook: "25/1000"

      # Actions
      PacketPlayInArmAnimation: "30/1000"
      PacketPlayInBlockDig: "50/1000"
      PacketPlayInUseItem: "25/1000"
      PacketPlayInUseEntity: "20/1000"
      PacketPlayInEntityAction: "25/1000"

      # Inventory (Dupe-sensitive)
      PacketPlayInWindowClick: "25/500"
      PacketPlayInSetCreativeSlot: "15/1000"
      PacketPlayInPickItem: "12/1000"
      PacketPlayInCloseWindow: "15/1000"

      # Anticheat bypass detection
      PacketPlayInKeepAlive: "10/1000"
      PacketPlayInTransaction: "18/1000"
      PacketPlayInTeleportAccept: "12/1000"

      # Recipe & Book
      PacketPlayInAutoRecipe: "8/1000"
      PacketPlayInRecipeDisplayed: "8/1000"
      PacketPlayInRecipeSettings: "12/1000"
      PacketPlayInBEdit: "3/2000"

      # Trading & Merchants
      PacketPlayInTrSel: "10/1000"

      # System commands
      PacketPlayInClientCommand: "5/1000"
      PacketPlayInSpectate: "8/1000"
      PacketPlayInAdvancements: "8/1000"
      PacketPlayInDifficultyLock: "5/2000"
      PacketPlayInDifficultyChange: "5/2000"

      # Communication
      PacketPlayInCustomPayload: "12/1000"
      PacketPlayInTabComplete: "15/1000"
      PacketPlayInChat: "10/2000"

      # Misc
      PacketPlayInVehicleMove: "25/1000"
      PacketPlayInSteerVehicle: "25/1000"
      PacketPlayInAbilities: "10/1000"
      PacketPlayInBeacon: "10/1000"
      PacketPlayInEnchantItem: "10/1000"
      PacketPlayInResourcePackStatus: "5/2000"
      PacketPlayInUpdateSign: "5/1000"
      PacketPlayInItemName: "6/1000"

  block-place:
    enabled: true
    kick-on-illegal-block: false # No forgiveness
    max-pps: 12 # More than 12 blocks per second (Printer/FastPlace) are blocked.
    check-coordinates: true

    # Printer Detection
    printer-check: true
    printer-threshold: 6 # Over 6 PPS is suspicious
    printer-leave-delay: 8000 # 8s wait penalty when disabling printer

    velocity:
      a: "80/500" # Velocity check tightened
      b: "50/1000"

    prevent-illegal-blocks: true
    illegal-blocks:
      - "COMMAND_BLOCK"
      - "REPEATING_COMMAND_BLOCK"
      - "CHAIN_COMMAND_BLOCK"
      - "STRUCTURE_VOID"
      - "STRUCTURE_BLOCK"
      - "JIGSAW"
      - "END_PORTAL_FRAME"
      - "LIGHT"

  item-exploit:
    enabled: true
    max-nbt-size: 2048
    max-string-len: 100 # Lore/Name length cannot exceed 100 characters.
    max-lore-size: 10 # An item can have max 10 lines of lore.
    max-list-size: 100
    max-array-size: 256
    max-total-nodes: 1000
    max-depth: 7
    max-attributes: 7
    max-attribute-value: 100

    illegal-keys:
      - "run_command"
      - "clickEvent"
      - "hoverEvent"
      - "Score" # Scoreboard exploit
      - "Selector" # Selector exploit
      - "translation.test.invalid"
      - "BlockEntityTag"

    nbt-occurrences:
      - "extra:15"      # Block JSON bombs
      - "{:50"          # Block nested NBT
      - "translate:5"   # Block translation key spam
      - "score:5"       # Block Scoreboard crash

  position:
    enabled: true
    max-offset: 400.0 # Stricter movement area
    elytra-speed-limit: 4.0
    out-of-world-limit: 30000000.0
    check-teleport-delay: true
    ignore-fly: true

  book:
    enabled: true
    max-pages: 5 # No one should write a novel, 5 pages is enough.
    max-bytes-per-page: 150
    strip-ascii: true

  payload:
    enabled: true
    max-size: 1024 # Large packets (except Maps etc.) are blocked.
    max-frequency: "4/1000" # Payload spam ended.
    blocked-channels:
      - "MC|BEdit"
      - "MC|BSign"
      - "MC|BOpen"
      - "PacketPlayInUpdateSign"
      - "WDL|INIT"
      - "PERMISSIONS_REPL"
      - "MC|TrList"
      - "minecraft:bedit"
      - "minecraft:bsign"
      - "minecraft:bopen"
      - "wdl:init" # WorldDownloader
      - "world_downloader"
      
  command:
    enabled: true
    block-syntax: true
    blacklist:
      - "/calc"
      - "//calc"
      - "/eval"
      - "//eval"
      - "/solve"
      - "//solve"
      - "/hd readtext"
      - "/pex"
      - "/op"
      - "/deop"
      - "/stop"
      - "/minecraft:me"
      - "/bukkit:me"
      - "/me"
      - "/execute"
      - "/function"
      - "/reload"
      - "/rl"
  tab:
    enabled: true
    max-length: 32 # Long command completions blocked.
    block-chars:
      - "["
      - "]"
      - "{"
      - "}"
      - "\\"
      - ":"
      - ";"
      - "@"
      - "="
      - "\""
      - "'"
      - "`"
      - "$" # Log4j
    block-contains:
      - "targetoffset"
      - "for("
      - "selector"
      - "run_command"
      - "^(."
      - "*."
      - "execute"
      - "summon"
      - "nbt"
      - "tag"
      - "uuid"
      - "score"
      - "jndi" # Log4j
      - "ldap" # Log4j
      - "rmi" # Log4j
    blacklisted-commands:
      - "/ver"
      - "/version"
      - "/about"
      - "/?"
      - "/help"
      - "/pl"
      - "/plugins"
      - "/bukkit:ver"
      - "/bukkit:pl"
      - "/minecraft:me"
      - "/icanhasbukkit"
      
packet-logger:
  enabled: false
  heavy-packet-threshold: 5000000 # 5ms (nanoseconds)
  output: FILE
  players: []
  packet-mode: BLACKLIST # WHITELIST or BLACKLIST
  packets:
    - "PacketPlayInKeepAlive"
    - "PacketPlayInFlying"
    - "PacketPlayInPosition"
    - "PacketPlayInLook"
    - "PacketPlayInPositionLook"

mechanics:
  nether-portal-delay: true
  nether-portal-cooldown-ms: 4000 # 4s cooldown after passing through portal
  max-arrow-velocity: 12.0 # Bow speed significantly reduced
  shears-cooldown: true
  break-close-inventory: true
  interact-container-delay: 300 # Chest opening interval 300ms (No spam)
  prevent-portal-break: true
  prevent-mule-dupe: true
  block-dead-packets: true
  null-chunk: true
  self-damage: true
  bed-duplication: true
  disable-piglin-trading: false
  close-inventory-on-teleport: true
  limit-falling-blocks: true
  max-falling-blocks-per-chunk: 10
  prevent-nether-roof: true
  limit-map-creation: true
  prevent-invalid-trade: true
  prevent-piston-crash: true
  trapdoor-rail-redstone: true
  prevent-anvil-dupe: true
  prevent-furnace-dupe: true
  prevent-hopper-dupe: true
  prevent-end-teleport-exploits: true
  prevent-dispenser-spam: true